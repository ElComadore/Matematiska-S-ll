\todo{Allmän källhänvissning krävs härnere}
%Over the course of this report we have refered to, and approximated, the distribution of variouss classifications of prime numbers. Using now our implementation of Helfgott's origianl code we seek to present the legitimacy of said distributions and also reflect on the quality of the code which we have written. The specific distributions to be presented are those of the regular prime numbers, the twin primes, and a the frequency of various prime gaps will also be presented. For each of these implementations have slight modifications been made to the code, which will be briefly discussed.

Genom rapportens gång har vi hänvisat till, och uppskattat fördelningen av, ett antal klasser av primtal och deras egenskaper. 
Nu, med användning av vår implementering av Helfgotts ursprunglig kod, ämnar vi att först redovisa legitimiteten av vår kod med stöd av primtalssatsens förväntad primtalsfördelning. 
Sedan undersöker vi den möjliga sanningen av en hypotetisk fördelning för primtalstvillingar. 
Slutligen redovisas frekvensen av primtalsgapp, och mönster som uppträder där i.
För varje implementering vilket kräver justering av koden, kommer dessa modifikationer förklaras kort, därmed finns fullständigt kod för modifikationerna i Appendix XXX - YYY.

\subsubsection{Fördelningen av primtal}\label{app.primes.title}
%Beginning with the classic example of the set of prime numbers, below is illustrated the distribution predicted by the familiar x over log x from sieve theory/Chebychev, the more accurate lorgarithmic integral Li(x), and the actual number of primes found in using our implementation. In order to generate the following graph, no new sieving methods were introduced, simply the counting fucntion in Appendix X

Vi börjar med att jämföra antalet primtal hittat med \textsc{NewSegSiev} emot fördelningen som ges av primtalssatsen, nämligen
\begin{equation}
    \pi(x) \sim \text{Li}(x) = \int_2^x\frac{1}{\log t}dt\label{app.primes.PNT}.
\end{equation}
För att skapa följande figur använder vi bara vår implementering av Helfgotts kod och en enkel räknesfunktion, Appendix XXX.

\begin{figure}[H]
    \centering
    \includegraphics[width = \textwidth]{coen/Images/Primes.pdf}
    \caption{I figuren till vänster redovisas antalet primtal som förväntas enligt primtalssatsen, \textit{orange}, och antalet primtal som hittades enligt \textsc{NewSegSiev}, \textit{blå}, då \(n = 10^{19}\), \(\Delta = 1.25\cdot10^{9}\), och \(K = 2.5\). 
    Notera gärna att kurvorna ligger nästan på varandra. 
    I de figuren till höger redovisas zoomade versioner av grafen till vänster för att visa skillnaden mellan vår uppskattning och det som förväntas vid början av intervallet, där algoritmen returnerar kring 100 färre primtal än förväntat, och vid slutet av intervallet, där algoritmen returnerar kring 2000 färre.}
    %This graph shows the relative distributions of primees as per the aforementioned fucntions. Notice that while x over log x appears relatively close for smaller x the logarithmic integral approximation is a near exact match for the true distribution, so much so that the code line is hidden.
    \label{fig:res.prime}
\end{figure}
%As shown in figure X, should we believe in the PNT it seems as though our code does indeed find the correct number of primes. The rather large error in the x over log x estimate is indicative/reflective of one of the limitations highlighted in Section XXX, namely the impact of the error terms and their reconcillation with the main terms. Howeve, there doest exist a deeper link between the x over log x estimate and that of the logarithmic integral. Throguh the use of integral wizardry you can decompose the logarithmic integral into a series of terms, the first of which being x over log x with the remainder being of the order of sqrt(x). This then accounts for the increase in error as x grows. Thiese kinds of approximations for the prime counting function can also be rather naturally extrapolated to those for twin primes, as discussed below.

Som vi ser i vänstra grafen av figur \ref{fig:res.prime}, då vi nu tror på primtalssatsen så verkar det som vår kod hittar det korrekta antalet primtal i intervallet, eftersom skillnaden mellan kurvorna är nästa osynlig på makronivå. 
Att de inte ligger exakt på varandra är huvudsakligen beroende på felet vilket inte visas i \eqref{app.primes.PNT}.
Att vår kod hittar ungefär 100 färre primtal än förväntat efter 20 000 heltal och ungefär 2000 färre primtal efter \(2.5\times10^9\) heltal är mycket rimligt då vi anser att felet i \eqref{app.primes.PNT} kan bäst vara \(O(x^{1/2 + \varepsilon}),\; \varepsilon > 0\), då Riemannhypotesen gäller.

Vi väljer \textit{n} som den är för att först och främst undersöka så långt ifrån noll som möjligt, med tanke på att öka feltermen för \eqref{app.primes.PNT}\footnote{Att \textit{n} inte valdes större i detta fallet är på grund av körningstiden för koden.}.
Följaktligen väljer vi \(\Delta\) på så sätt att vi använder Helfgotts förbättringar i \textsc{NewSegSiev}, \textsc{DiophAppr} funktionen, och för att göra det krävs en specifik storlek på intervallet.
Slutligen väljer vi \textit{K} till 2.5 för att det är minsta \textit{K}:et som kan vals enligt Helfgott.
Tillsammans bildar dessa parametrar, med stöd från primtalssatsen, en bra bas för de följande tillämpningar då vi sparar bitarry:n och läser in den istället för att hitta alla primtal över igen.

\subsubsection{Fördelningen av primtalstvillingar}
%Continuing our presentation of various sets of prime's distributions, next we turn to the other recurring theme of twin primes. The following figure illustrates the distributions of twin primes as predicted by x over log squared x and the second order logarithmic integral against those primes found using our implementation. It should be noted that a rather simple help function, Appendix XXX, was written which searches for non twin primes in the prime list and removes them.

Med hjälp av de primtal vi hittade i \ref{app.primes.title}, vänder vi oss nu till primtalstvillingar och deras hypotetisk fördelning. Det finns ingen sats för primtalstvillingar vilket motsvarar primtalssatsen för de enkla primtalsens fördelning, dock så finns det en hypotetisk fördelning vilket är
\begin{equation}
    \pi_2(x) \sim 2\text{C}_2\cdot \text{Li}_2(x) = 2\text{C}_2\int_2^x\frac{1}{(\log t)^2}dt\label{app.twins.TWN}
\end{equation}
där \(\text{C}_2 = 0.6608...\) är primtalstvillingskonstanten. Då vi jämför den hypotetiska fördelningen emot antalet tvillingsprimtal vi har genererat, så får vi följande figur.

\begin{figure}[H]
    \centering
    \includegraphics[width = \textwidth]{coen/Images/TwinPrimesNoKapp.pdf}
    \caption{I grafen till vänster redovisas antalet primtalstvillingar som förväntas enligt den hypotetiska fördelningen, \textit{orange}, och de primtalstvillingar som hittades enligt \textsc{NewSegSiev}, \textit{blå}, då \(n = 10^{19}\), \(\Delta = 1.25\times10^9\), och \(\text{C}_2\) har avrundats till 0.66. Notera gärna igen att kurvorna ligger nästan på varandra. I de graferna till höger så redovisas igen zoomade versioner av grafen till vänster. Dessa graf visar skillnaden mellan antalet primtalstvilling vi har hittat och antalet som förväntas vid slutet av intervallet, där algoritmen returnerar 500 fler primtalstvillingar, och vi början av intervallet, där efter de första 20000 heltal i intervallet så har algoritmen genererat nästan det exakt antalet primtalstvillingar som förväntas.}
    %This graph shows the relative distributions of the twin primes as per the aforementioned fucntions. Notice once again the accuarcy of the logarithmic integral, once again hiding our code line, as opposed to that of C x over log squared x, where the constant is 2*C_2, or 2 times the twin prime constant (discussed below).
    \label{fig:res.twins}
\end{figure}

Figur \ref{fig:res.twins} ger oss några intressanta insikter angående primtalstvillingar. 
Den första är att den ger stöd till den hypotetiska fördelningen vilket anknuten till primtalstvillingar. 
Som vi ser i grafen till vänster, då vi nu litar på koden (vilket i sin tur stöds av primtalssatsen enligt figur \ref{fig:res.prime}) så kan hypotetiska fördelningen för primtalstvillingar vara definitivt möjligt eftersom kurvorna verkar ligga på varandra.
Då vi kollar på mindre delintervall, som i graferna till höger, så stöds hypotetiska fördelningen av det felet så fås. 
Vid början av intervallet är skillnaden mellanantal primtalstvillingar som förväntas och antalet som hittades maximalt 4, och vid slutet så har felet ökat till ungefär 500.
I sammanhanget av en interval av längd \(2.5\times10^9\) så är en skillnad på 500 mellan de ekvivalent med en avvikelse av \(2\times 10^{-7}\) mer primtalstvillingar per heltal än vad som förväntades.
Att antalet primtalstvillingar blir större än antalet som är förväntad vid slutet på intervallet är, i vår åsikt, beroende på att vi avrundar \(\text{C}_2\) till 0.66 vilket påverkar den förväntade fördelningen mycket när talen blir så stor som de är.

Den andra insikten grafen ger är kopplade till anmärkningen vid slutet på tillämpningen av Eratosthenes såll i avsnitt \ref{Eratosthenes}. Vi noterar där att Bruns sats medför att andelen primtalstvillingar av primtalen är relativt liten och då vi jämför graferna i figurer \ref{fig:res.prime} och \ref{fig:res.twins} kan vi se det förväntade relationen.
Vi ser direkt att antalet primtal bland de första 20000 heltal i den första figuren är kring 400 vilket är ungefär 30 gånger fler än antalet primtalstvillingar som finns i de första 20000 heltal som betraktas.
Då vi kollar istället vid slutet på intervallet blir kvoten mellan antalet primtal och antalet primtalstvillingar inte mindre; den ökar lite till ungefär 33 fler enkla primtal jämfört emot tvillingar.

Vi kan inte använda vår kod som bevis för den hypotetiska fördelningen för primtalstvillingar dock så kan vi få en känsla för om fördelningen verkar rimligt i detta fallet, vilket den gör. Vi kan också få en känsla för hur få primtalstvillingar det finns jämfört emot antalet primtal, vilket underlättar förståelsen av en av sållteorins stora framsteg, nämligen Bruns sats.


%There are a number of things to discuss regardng the above figure. 
\subsubsection{Frekvens av primtalsgap}

Vi fortsätter med att ge visualiseringar av olika egenskaper av de primtal vi har hittat med att undersöka frekvensen av olika storlekar av primtalsgap. 
En primtalsgap är avståndet mellan ett primtal och sitt efterföljande primtal.
Man kan, med hjälp av primtalssatsen, visa att det förväntade avståndet mellan ett primtal \(p_n\) och nästa, \(p_{n+1}\), är \(\log p_n\).
Dock, som antyddes kort till i inledningden, finns oändligt många par av primtal med maximalt 600 steg emellan sig vilket betyder att, även för de stora primtalen, måste det finnas primtal relativt nära varandra.
Detta bevisades med hjälp av nya sållmetoder, specifikt GPY metoder vilket är döpta efter de tre matematikerna om utvecklade metoden, där vikterna i metoden liknade de som används i Selbergs såll. 
Målet är att en dag kunna reducerar de 600 steg till 2 och därmed bevisa primtalstviliingshypotesen.
För att ge intuition om hur verklig det som har bevisats är analyserar vi nu de primtalsgap som finns i listan av primtal vi generade i \ref{app.primes.title} med att först redovisa följande figur.

\begin{figure}[H]
    \centering
    \includegraphics[width = \textwidth]{coen/Images/GapsNoKapps.pdf}
    \caption{I figuren så redovisas frekvensen på olika stora primtalsgap i det intervallet som undersöktes tidigare, då \(n = 10^{19}\), \(\Delta = 1.25\cdot10^{9}\), och \(K = 2.5\). Notera att y-axeln är logaritmerad på grund av hur högt frekvensen är för de små primtalsgap. }
    \label{fig:res.gap}
\end{figure}

I figur \ref{fig:res.gap} får vi några insikter kring beteendet av primtalsgap i vårt intervall angående deras fördelning. 
Det mest överraskande aspekten av grafen, för någon som har inte sett en sådan graf förut, är hur rak den är då vi logaritmerar y-axeln.
Detta påpekar att frekvensen på primtalsgap minskar exponentiellt då dess längd ökar. 
Vi ser att det mest frekvent längd på primtalsgap i vårt intervall var 6 och längsta strecket utan något primtal var av längd 668.
En till detalj vilket inte kan läsas lätt av figuren är att det finns par av primtal i intervallet där avståndet mellan dem är lika med varje jämn tal upp till och inklusive 560.
Vi nämnde tidigare att det förväntade längden på primtalsgapet för ett primtal \textit{p} tills nästa primtal är \(\log(p)\). 
Då vi uppskattar våra primtal i intervallet med \(10^{19}\) får vi att det förväntade längden på ett primtalsgap i intervallet är ungefär 43.7491. 
Vi ser att många avstånd överstiger detta och ännu fler är mycket mindre, dock då vi beräknar det genomsnittliga längden på primtals gap i vårt intervall så får vi det till 43.7505.
Återigen stöder denna resultat legitimiteten av vår kod eftersom den bygger på den välkända resultaten av primtalssatsen.

Om vi återgår till primtalstvillingar så ger figuren även något om de. 
Vi kan se att om alla primtal med ett visst primtals gap tills nästa primtal skulle betraktas vara lika speciellt som primtalstvillingar, då skulle primtalstvillingar vara de sjunde vanligaste typ av primtal i vårt intervall, och består av 0.03 procent av alla primtal i intervallet.

Såsom mycket andra angående primtal, finns det åtminstone en förmodan kopplade till dessa frekvenser ovan, och vilket primtalsgap är mest frekvent upp till ett givet övregräns. 
Som vi ser i figur \ref{fig:res.gap} är 6 det mest frekventa längden på primtals gap i vår interval, och det som är speciellt med 6 är att det är produkten av de första två primtalen. 
Vi ser också från figuren att 30, vilket är produkten av de första 3 primtalen, hoppar upp lite från översta delen av bandet, och även 210 med. Förmodan är då att varje \textit{primorial}, produkt av de första \textit{m} primtalen, någon gång blir "hoppmästaren" (namnet gavs av J. H. Conway, 1993).
Förmodan har undersökts direkt med med hjälp numeriska uppskattnings metoder \cite{primeGap} och har visat att 6 är hoppmästaren fram till \(\approx 1.74\cdot10^{35}\) och att 30 är hoppmästaren mellan föregående och \(\approx 10^{425}\).
